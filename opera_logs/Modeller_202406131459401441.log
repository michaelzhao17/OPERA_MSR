/ Opera-3d Modeller
/ Opera 2020 SP3 [Build 2]
/ Started: 13/Jun/2024 14:59:40
/ Node: TUCAN-MAGPC. Processor: Intel64. System: Windows 10

$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
FILTER TYPE=BODY
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PICK OPTION=GUIUPDATE
PICK OPTION=ADD, | PICK PROPERTY=UniqueName LABEL=Unnamed:AAA-001
PICK OPTION=REMOVE, | PICK PROPERTY=UniqueName LABEL=Unnamed:AAA-001
PICK OPTION=ADD, | PICK PROPERTY=Name LABEL=Unnamed
PICK OPTION=ADD, | PICK PROPERTY=Name LABEL=Unnamed
PICK OPTION=REMOVE, | PICK PROPERTY=Name LABEL=Unnamed
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=ACCEPT REDISPLAY=NO |  RENAME NAME='Unnamed' UNIQUENAME='Unnamed:AAA-001'
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
PICK OPTION=GUIUPDATE
PICK OPTION=ADD, | PICK PROPERTY=MaterialLabel LABEL=layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1
PICK OPTION=ADD, | PICK PROPERTY=MaterialLabel LABEL=layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'

PREVIEW OPTION=UNPICK REDISPLAY=YES
UNDO
UNDO
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES | PICK OPTION=RESET
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=ACCEPT REDISPLAY=NO |  RENAME NAME='laery5_floor' UNIQUENAME='Unnamed:AAA-001'
PICK OPTION=GUIUPDATE
PICK OPTION=TOGGLE, | PICK PROPERTY=MaterialLabel LABEL=layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1
PICK OPTION=TOGGLE, | PICK PROPERTY=MaterialLabel LABEL=layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1
PICK OPTION=ADD, | PICK PROPERTY=MaterialLabel LABEL=layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=ACCEPT REDISPLAY=NO |  RENAME NAME='laery5_floor' UNIQUENAME='Unnamed:AAA-001'
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

REPLAY OPTION=REBUILDPREPARE STATE=' '
PREVIEW OPTION=UNPICK REDISPLAY=YES | PICK OPTION=RESET
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES | PICK OPTION=RESET
PICK OPTION=GUIUPDATE
PICK OPTION=TOGGLE, | PICK PROPERTY=MaterialLabel LABEL=layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES | PICK OPTION=RESET
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PICK OPTION=GUIUPDATE
PICK OPTION=ADD, | PICK PROPERTY=MaterialLabel LABEL=layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1
FILTER COMMAND=LIST
RENAME NAME='layer5_floor'
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES | PICK OPTION=RESET
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=ACCEPT REDISPLAY=NO |  RENAME NAME='test' UNIQUENAME='Unnamed:AAA-001'
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES | PICK OPTION=RESET
FILTER TYPE=BODY
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=MaterialLabel LABEL=layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1
PREVIEW OPTION=ACCEPT REDISPLAY=NO | RENAME NAME='layer5_floor'
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
SELECT OPTION=DEFAULT
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=ACCEPT REDISPLAY=NO |  RENAME NAME='Unnamed' UNIQUENAME='Unnamed:AAA-001'
PICK OPTION=GUIUPDATE
PICK OPTION=ADD, | PICK PROPERTY=MaterialLabel LABEL=layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1
PREVIEW OPTION=ACCEPT REDISPLAY=NO |  RENAME NAME='aaa' UNIQUENAME='Unnamed:AAA-001'
PICK OPTION=GUIUPDATE
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PICK OPTION=ALL TYPE=BODY
PICK OPTION=CHANGE TYPE=BODY
PICK OPTION=CHANGE TYPE=BODY
FILTER COMMAND=LIST
PICK OPTION=GUIUPDATE
PICK OPTION=ADD, | PICK PROPERTY=MaterialLabel LABEL=layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1
FILTER COMMAND=LIST
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
| PICK OPTION=RESET
PICK OPTION=GUIUPDATE
PICK OPTION=ADD, | PICK PROPERTY=MaterialLabel LABEL=layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1
CELLDATA OPTION=MODIFY MATERIALLABEL='layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1' POTENTIAL=Default ELEMENTTYPE=Linear ELEMSHAPEPREF=NONE
| PICK OPTION=RESET
PICK OPTION=GUIUPDATE
PICK OPTION=ADD, | PICK PROPERTY=MaterialLabel LABEL=layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1
CELLDATA OPTION=MODIFY MATERIALLABEL='layer5_floor_NAUO1#MSR_floor_NAUO2#layer5_floor_Stock_layer5_1' POTENTIAL=Default ELEMENTTYPE=Linear ELEMSHAPEPREF=NONE
CELLDATA OPTION=MODIFY MATERIALLABEL='layer5_floor_NAUO1#MSR_floor_NAUO2layer5_floor_Stock_layer5_1' POTENTIAL=Default ELEMENTTYPE=Linear ELEMSHAPEPREF=NONE
CELLDATA OPTION=MODIFY MATERIALLABEL='layer5_floor' POTENTIAL=Default ELEMENTTYPE=Linear ELEMSHAPEPREF=NONE
PICK OPTION=GUIUPDATE
PICK OPTION=ADD, | PICK PROPERTY=MaterialLabel LABEL=layer5_floor
| PICK OPTION=RESET
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'

PREVIEW OPTION=UNPICK REDISPLAY=YES
FILTER TYPE=BODY
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=ACCEPT REDISPLAY=NO |  RENAME NAME='layer5_floor' UNIQUENAME='Unnamed:AAA-001'
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
FILTER TYPE=FACE
PREVIEW OPTION=PICK | PICK OPTION=ADD TYPE=FACE UNIQUEBODYNAME='Unnamed:AAA-001' IDENTIFIER=A.00112

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD TYPE=FACE UNIQUEBODYNAME='Unnamed:AAA-001' IDENTIFIER=A.00112

PREVIEW OPTION=ACCEPT REDISPLAY=NO |  FACEDATA OPTION=MODIFY ELEMENTTYPE=Linear FORMETHOD=NONE BACKMETHOD=GEOMETRY BACKLAYERS=4 BACKOFFSET=0.0005
PREVIEW OPTION=PICK | PICK OPTION=ADD TYPE=FACE UNIQUEBODYNAME='Unnamed:AAA-002' IDENTIFIER=A.00032

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD TYPE=FACE UNIQUEBODYNAME='Unnamed:AAA-003' IDENTIFIER=A.00032

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD TYPE=FACE UNIQUEBODYNAME='Unnamed:AAA-004' IDENTIFIER=A.00032

PREVIEW OPTION=UNPICK REDISPLAY=YES
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='l5_floor'

PREVIEW OPTION=UNPICK REDISPLAY=YES | PICK OPTION=RESET
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-003'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAA-002'

PREVIEW OPTION=UNPICK REDISPLAY=YES
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
PREVIEW OPTION=PICK | PICK OPTION=ADD TYPE=FACE UNIQUEBODYNAME='Unnamed:AAB-004' IDENTIFIER=A.00013

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD TYPE=FACE UNIQUEBODYNAME='Unnamed:AAB-003' IDENTIFIER=A.00011

PREVIEW OPTION=UNPICK REDISPLAY=YES
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
PREVIEW OPTION=PICK | PICK OPTION=ADD TYPE=FACE UNIQUEBODYNAME='l1_door' IDENTIFIER=A.00013

PREVIEW OPTION=UNPICK REDISPLAY=YES
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'
FILTER TYPE=BODY
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Unnamed:AAC-001'

PREVIEW OPTION=UNPICK REDISPLAY=YES
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='l3_door'

PREVIEW OPTION=UNPICK REDISPLAY=YES

PREVIEW OPTION=UNPICK REDISPLAY=YES
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'

PREVIEW OPTION=UNPICK REDISPLAY=YES

PREVIEW OPTION=UNPICK REDISPLAY=YES
SKETCH OBJECT=BLOCK +COMPLETE

RACETRACK OPTION=LOAD
RACETRACK OPTION=NEW -KEEP XP1=5.50 YP1=-0.005 WIDTH=0.01 THICKNESS=0.01 H1=2.75 R1=0.01 INCIRCUIT=NO CIRCUITELEMENT= CURD=1 TOLERANCE=TOLERANCE DRIVELABEL='Default_Drive' THETA2=0 PHI2=0 PSI2=0 XCEN2=0 YCEN2=0 ZCEN2=0 LCNAME='Global coordinate system' RXY=0 RYZ=0 RZX=0 SYMMETRY=1 MODELCOMPONENT=NO
RACETRACK OPTION=LOAD
RACETRACK OPTION=NEW -KEEP XP1=2.75 YP1=-5.0E-03 WIDTH=0.01 THICKNESS=0.01 H1=2.75 R1=0.01 INCIRCUIT=NO CIRCUITELEMENT= CURD=1 TOLERANCE=0 DRIVELABEL='Default_Drive' THETA2=0 PHI2=0 PSI2=0 XCEN2=0 YCEN2=0 ZCEN2=0 LCNAME='Global coordinate system' RXY=0 RYZ=0 RZX=0 SYMMETRY=1 MODELCOMPONENT=NO
RACETRACK OPTION=LOAD
MULTIPHYSICS OPTION=RESET
DBCASEDATA PROGRAM=ELEKTRATR OPTION=ADD VALUE=0;10;1
ANALYSISDATA OPTION=SET PROGRAM=ELEKTRATR DELTAT=1 HX=0 HY=0 HZ=0 LINEAR=NO LOGLIST= LOGLIST+=TTime NITERATIONS=21 NLITERTYPE=NEWTON RHS=ADAPTIVE TOLERANCE=0.001 UPDATE=SIMPLE USEDEFORMEDMESH=NO
DRIVE UNPICK | DRIVE GUIINIT
DRIVE PICK 'Default_Drive'
DRIVE OPTION=MODIFY TYPE=SINE SINFREQUENCY=0.1 SCALE=10000 | DRIVE UNPICK
$ COMI 'C:\Users\mzhao\OPERA_MSR\layer_meshing_ver.comi'

PREVIEW OPTION=UNPICK REDISPLAY=YES

PREVIEW OPTION=UNPICK REDISPLAY=YES
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'

PREVIEW OPTION=UNPICK REDISPLAY=YES
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'

PREVIEW OPTION=UNPICK REDISPLAY=YES
SOLVERS ELEMENT=LINEAR,| SOLVERS SOLVENOW=NO SAVEMODEL=YES, | SOLVERS OPTION=TEST FILE='pure_perturbation' UNITS=METRE SURFACE=CURVED | COMMENT CLEAR=YES TYPE=DBTITLE | COMMENT TEXT='Perturbation in vacuum, to test field created at center' | SOLVERS OPTION=OVERWRITE
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
MULTIPHYSICS OPTION=RESET
ANALYSISDATA OPTION=SET PROGRAM=ELEKTRATR DELTAT=1 HX=0 HY=0 HZ=0 LINEAR=NO LOGLIST= LOGLIST+=TTime NITERATIONS=21 NLITERTYPE=NEWTON RHS=ADAPTIVE TOLERANCE=0.001 UPDATE=SIMPLE USEDEFORMEDMESH=NO
DRIVE UNPICK | DRIVE GUIINIT
DRIVE UNPICK
MULTIPHYSICS OPTION=RESET
ANALYSISDATA OPTION=SET PROGRAM=ELEKTRATR DELTAT=0.5 HX=0 HY=0 HZ=0 LINEAR=NO LOGLIST= LOGLIST+=TTime NITERATIONS=21 NLITERTYPE=NEWTON RHS=ADAPTIVE TOLERANCE=0.001 UPDATE=SIMPLE USEDEFORMEDMESH=NO
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='ModelBody'

PREVIEW OPTION=UNPICK REDISPLAY=YES
CLEAR REVERT=NO
YES
RACETRACK OPTION=LOAD
RACETRACK OPTION=NEW -KEEP XP1=2.75 YP1=-5.0E-03 WIDTH=0.01 THICKNESS=0.01 H1=2.75 R1=0.01 INCIRCUIT=NO CIRCUITELEMENT= CURD=88 TOLERANCE=0 DRIVELABEL='Perturbation' THETA2=0 PHI2=0 PSI2=0 XCEN2=0 YCEN2=0 ZCEN2=0 LCNAME='Global coordinate system' RXY=0 RYZ=0 RZX=0 SYMMETRY=1 MODELCOMPONENT=NO
// Set current, with scale factor to corrrect units
DRIVE UNPICK | DRIVE GUIINIT
DRIVE PICK 'Perturbation'
DRIVE OPTION=MODIFY TYPE=SINE SINFREQUENCY=0.1 SCALE=10000 | DRIVE UNPICK
// create reduced airblock
SKETCH OBJECT=BLOCK +COMPLETE
PREVIEW OPTION=START REDISPLAY=NO | BLOCK Name='Block' X0=6 Y0=6 Z0=6 X1=-6 Y1=-6 Z1=-6 MATERIALLABEL='Air' LEVEL=300
PREVIEW OPTION=END REDISPLAY=NO |  BLOCK Name='Block' X0=6 Y0=6 Z0=6 X1=-6 Y1=-6 Z1=-6 MATERIALLABEL='Air' LEVEL=300
CLEAR REVERT=NO
yes
RACETRACK OPTION=LOAD
RACETRACK OPTION=NEW -KEEP XP1=2.75 YP1=-5.0E-03 WIDTH=0.01 THICKNESS=0.01 H1=2.75 R1=0.01 INCIRCUIT=NO CIRCUITELEMENT= CURD=88 TOLERANCE=0 DRIVELABEL='Perturbation' THETA2=0 PHI2=0 PSI2=0 XCEN2=0 YCEN2=0 ZCEN2=0 LCNAME='Global coordinate system' RXY=0 RYZ=0 RZX=0 SYMMETRY=1 MODELCOMPONENT=NO
// Set current, with scale factor to corrrect units
DRIVE UNPICK | DRIVE GUIINIT
DRIVE PICK 'Perturbation'
DRIVE OPTION=MODIFY TYPE=SINE SINFREQUENCY=0.1 SCALE=10000 | DRIVE UNPICK
SKETCH OBJECT=BLOCK +COMPLETE
BLOCK Name='Block' X0=6 Y0=6 Z0=6 X1=-6 Y1=-6 Z1=-6 MATERIALLABEL='Air' LEVEL=300
FILTER TYPE=BODY
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Block'

PREVIEW OPTION=ACCEPT REDISPLAY=NO |  CELLDATA OPTION=MODIFY MATERIALLABEL='Air' POTENTIAL=Reduced ELEMENTTYPE=Linear LEVEL=300 ELEMSHAPEPREF=NONE
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'

PREVIEW OPTION=UNPICK REDISPLAY=YES
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'

PREVIEW OPTION=UNPICK REDISPLAY=YES
MODEL DELETE
PREVIEW OPTION=PICK | PICK OPTION=ADD PROPERTY=UniqueName LABEL='Block'

PREVIEW OPTION=ACCEPT REDISPLAY=NO |  CELLDATA OPTION=MODIFY MATERIALLABEL='Air' POTENTIAL=Total ELEMENTTYPE=Linear LEVEL=300 SIZE=0.05 ELEMSHAPEPREF=NONE
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
DRIVE UNPICK | DRIVE GUIINIT
DRIVE PICK 'Perturbation'
DRIVE UNPICK
CLEAR REVERT=NO
yes
STRAIGHT OPTION=LOAD
STRAIGHT OPTION=NEW -KEEP WIDTH=0.01 THICKNESS=0.01 H1=1 INCIRCUIT=NO CIRCUITELEMENT= CURD=88 TOLERANCE=TOLERANCE DRIVELABEL='Default_Drive' THETA2=0 PHI2=0 PSI2=0 XCEN2=0 YCEN2=0 ZCEN2=0 LCNAME='Global coordinate system' RXY=0 RYZ=0 RZX=0 SYMMETRY=1 MODELCOMPONENT=NO

PREVIEW OPTION=UNPICK REDISPLAY=YES
STRAIGHT OPTION=LOAD
CLEAR REVERT=NO
yes
STRAIGHT OPTION=LOAD
STRAIGHT OPTION=NEW -KEEP WIDTH=0.01 THICKNESS=0.01 H1=5.5 INCIRCUIT=NO CIRCUITELEMENT= CURD=88 TOLERANCE=TOLERANCE DRIVELABEL='Default_Drive' THETA2=0 PHI2=0 PSI2=0 XCEN2=0 YCEN2=0 ZCEN2=0 LCNAME='Global coordinate system' RXY=0 RYZ=0 RZX=0 SYMMETRY=1 MODELCOMPONENT=NO
SKETCH OBJECT=CYLINDER +COMPLETE
PREVIEW OPTION=START REDISPLAY=NO | CYLINDER Name='Cylinder' X0=-5.6 Y0=0 Z0=0 X1=5.6 Y1=0 Z1=0 -TUBE SHAPECONTROL=SIMPLE MAJORRADIUS=0.5 MINORRADIUS=0.5 TOPRADIUS=0.5 SIDES=2
PREVIEW OPTION=START REDISPLAY=NO | CYLINDER Name='Cylinder' X0=0 Y0=0 Z0=-5.6 X1=0 Y1=0 Z1=5.6 -TUBE SHAPECONTROL=SIMPLE MAJORRADIUS=0.5 MINORRADIUS=0.5 TOPRADIUS=0.5 SIDES=2
PREVIEW OPTION=END REDISPLAY=YES
STRAIGHT OPTION=LOAD
STRAIGHT OPTION=NEW -KEEP WIDTH=0.01 THICKNESS=0.01 H1=5.5 INCIRCUIT=NO CIRCUITELEMENT= CURD=88 TOLERANCE=0 DRIVELABEL='Default_Drive' LCNAME='Global coordinate system' XCEN2=2.75 YCEN2=0 ZCEN2=0 THETA2=0 PHI2=0 PSI2=0 RXY=0 RYZ=0 RZX=0 SYMMETRY=1 MODELCOMPONENT=NO

PREVIEW OPTION=UNPICK REDISPLAY=YES
THREED OPTION=SETVIEW SIZE=0
STRAIGHT OPTION=LOAD
STRAIGHT OPTION=NEW -KEEP WIDTH=0.01 THICKNESS=0.01 H1=5.5 INCIRCUIT=NO CIRCUITELEMENT= CURD=88 TOLERANCE=0 DRIVELABEL='Default_Drive' LCNAME='Global coordinate system' XCEN2=0 YCEN2=0 ZCEN2=2.75 THETA2=0 PHI2=0 PSI2=0 RXY=0 RYZ=0 RZX=0 SYMMETRY=1 MODELCOMPONENT=NO

PREVIEW OPTION=UNPICK REDISPLAY=YES
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'

PREVIEW OPTION=UNPICK REDISPLAY=YES
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
SKETCH OBJECT=CYLINDER +COMPLETE
PREVIEW OPTION=START REDISPLAY=NO | CYLINDER Name='Cylinder' X0=0 Y0=0 Z0=-2.75 X1=0 Y1=0 Z1=2.75 -TUBE SHAPECONTROL=SIMPLE MAJORRADIUS=0.5 MINORRADIUS=0.5 TOPRADIUS=0.5 SIDES=2 MATERIALLABEL='Air'
PREVIEW OPTION=START REDISPLAY=NO | CYLINDER Name='Cylinder' X0=0 Y0=0 Z0=-2.76 X1=0 Y1=0 Z1=2.76 -TUBE SHAPECONTROL=SIMPLE MAJORRADIUS=0.5 MINORRADIUS=0.5 TOPRADIUS=0.5 SIDES=2 MATERIALLABEL='Air'
PREVIEW OPTION=START REDISPLAY=NO | CYLINDER Name='Cylinder' X0=0 Y0=0 Z0=-2.76 X1=0 Y1=0 Z1=2.76 -TUBE SHAPECONTROL=SIMPLE MAJORRADIUS=0.5 MINORRADIUS=0.5 TOPRADIUS=0.5 SIDES=2 MATERIALLABEL='Air'
PREVIEW OPTION=END REDISPLAY=NO |  CYLINDER Name='Cylinder' X0=0 Y0=0 Z0=-2.76 X1=0 Y1=0 Z1=2.76 -TUBE SHAPECONTROL=SIMPLE MAJORRADIUS=0.5 MINORRADIUS=0.5 TOPRADIUS=0.5 SIDES=2 MATERIALLABEL='Air' LEVEL=300
SKETCH OBJECT=CYLINDER +COMPLETE
PREVIEW OPTION=START REDISPLAY=NO | CYLINDER Name='Cylinder' X0=0 Y0=0 Z0=-2.76 X1=0 Y1=0 Z1=2.76 -TUBE SHAPECONTROL=SIMPLE MAJORRADIUS=1 MINORRADIUS=1 TOPRADIUS=1 SIDES=2 MATERIALLABEL='Air' LEVEL=100
PREVIEW OPTION=END REDISPLAY=NO |  CYLINDER Name='Cylinder' X0=0 Y0=0 Z0=-2.76 X1=0 Y1=0 Z1=2.76 -TUBE SHAPECONTROL=SIMPLE MAJORRADIUS=1 MINORRADIUS=1 TOPRADIUS=1 SIDES=2 MATERIALLABEL='Air' LEVEL=100
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
CLEAR REVERT=NO
yes
SKETCH OBJECT=CYLINDER +COMPLETE
CYLINDER Name='Cylinder' X0=0 Y0=-1 Z0=0 X1=0 Y1=1 Z1=0 -TUBE SHAPECONTROL=SIMPLE MAJORRADIUS=35 MINORRADIUS=35 TOPRADIUS=35 SIDES=2
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
MULTIPHYSICS OPTION=RESET
DBCASEDATA PROGRAM=TOSCAMAGN OPTION=CLEAR
DBCASEDATA PROGRAM=TOSCAMAGN OPTION=INSERT VALUE=10000 INDEX=1
DBCASEDATA PROGRAM=TOSCAMAGN OPTION=DELETE INDEX=2
ANALYSISDATA OPTION=SET PROGRAM=TOSCAMAGN HX=0 HY=0 HZ=0 LINEAR=NO NITERATIONS=21 NLITERTYPE=NEWTON POTENTIALCUT=YES RHS=ADAPTIVE SCALEDRIVE=Perturbation TOLERANCE=0.001 USEDEFORMEDMESH=NO USEDIRECTSOLVER=NO
//// Create database
SOLVERS ELEMENT=LINEAR,| SOLVERS SOLVENOW=NO SAVEMODEL=YES, | SOLVERS OPTION=TEST FILE='pure_perturbation' UNITS=METRE SURFACE=CURVED | COMMENT CLEAR=YES TYPE=DBTITLE | COMMENT TEXT='Perturbation in vacuum, to test field created at center' | SOLVERS OPTION=OVERWRITE

MULTIPHYSICS OPTION=RESET
DBCASEDATA PROGRAM=TOSCAMAGN OPTION=CLEAR
ANALYSISDATA OPTION=SET PROGRAM=TOSCAMAGN HX=0 HY=0 HZ=0 LINEAR=NO NITERATIONS=21 NLITERTYPE=NEWTON POTENTIALCUT=YES RHS=ADAPTIVE SCALEDRIVE=Perturbation TOLERANCE=0.001 USEDEFORMEDMESH=NO USEDIRECTSOLVER=NO
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
DRIVE UNPICK | DRIVE GUIINIT
DRIVE PICK 'Perturbation'
DRIVE OPTION=MODIFY SCALE=10000
DRIVE OPTION=MODIFY SCALE=10000 | DRIVE UNPICK
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
MULTIPHYSICS OPTION=RESET
DBCASEDATA PROGRAM=ELEKTRATR OPTION=INSERT VALUE=0:10:1 INDEX=1
DBCASEDATA PROGRAM=ELEKTRATR OPTION=INSERT VALUE=0;10;1 INDEX=1
ANALYSISDATA OPTION=SET PROGRAM=ELEKTRATR DELTAT=1 HX=0 HY=0 HZ=0 LINEAR=NO LOGLIST= LOGLIST+=TTime NITERATIONS=21 NLITERTYPE=NEWTON RHS=ADAPTIVE TOLERANCE=0.001 UPDATE=SIMPLE USEDEFORMEDMESH=NO
DRIVE UNPICK | DRIVE GUIINIT
DRIVE PICK 'Perturbation'
DRIVE OPTION=MODIFY TYPE=SINE SINFREQUENCY=0.1 SCALE=10000
DRIVE OPTION=MODIFY TYPE=SINE SINFREQUENCY=0.1 SCALE=10000 | DRIVE UNPICK
SOLVERS ELEMENT=LINEAR,| SOLVERS SOLVENOW=YES SAVEMODEL=YES, | SOLVERS OPTION=TEST FILE='pure_perturbation_AC.op3' UNITS=METRE SURFACE=CURVED | COMMENT CLEAR=YES TYPE=DBTITLE | SOLVERS OPTION=OVERWRITE
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
DRIVE UNPICK | DRIVE GUIINIT
DRIVE PICK 'Perturbation'
DRIVE OPTION=MODIFY TYPE=DC SCALE=10000 | DRIVE UNPICK
SOLVERS ELEMENT=LINEAR,| SOLVERS SOLVENOW=YES SAVEMODEL=YES, | SOLVERS OPTION=TEST FILE='pure_perturbation_AC.op3' UNITS=METRE SURFACE=CURVED | COMMENT CLEAR=YES TYPE=DBTITLE | SOLVERS OPTION=OVERWRITE
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
SOLVERS ELEMENT=LINEAR,| SOLVERS SOLVENOW=NO SAVEMODEL=YES, | SOLVERS OPTION=TEST FILE='pure_perturbation_AC.op3' UNITS=METRE SURFACE=CURVED | COMMENT CLEAR=YES TYPE=DBTITLE | SOLVERS OPTION=OVERWRITE
MULTIPHYSICS OPTION=RESET
DBCASEDATA PROGRAM=ELEKTRATR OPTION=CLEAR
ANALYSISDATA OPTION=SET PROGRAM=ELEKTRATR DELTAT=0.5 HX=0 HY=0 HZ=0 LINEAR=NO LOGLIST= LOGLIST+=TTime NITERATIONS=21 NLITERTYPE=NEWTON RHS=ADAPTIVE TOLERANCE=0.001 UPDATE=SIMPLE USEDEFORMEDMESH=NO
DRIVE UNPICK | DRIVE GUIINIT
DRIVE PICK 'Perturbation'
DRIVE OPTION=MODIFY TYPE=DC SCALE=10000
DRIVE OPTION=MODIFY TYPE=DC SCALE=10000 | DRIVE UNPICK
SOLVERS ELEMENT=LINEAR,| SOLVERS SOLVENOW=YES SAVEMODEL=YES, | SOLVERS OPTION=TEST FILE='pure_perturbation_AC.op3' UNITS=METRE SURFACE=CURVED | COMMENT CLEAR=YES TYPE=DBTITLE | SOLVERS OPTION=OVERWRITE
DRIVE UNPICK | DRIVE GUIINIT
DRIVE PICK 'Perturbation'
DRIVE OPTION=MODIFY TYPE=COSINE COSFREQUENCY=0.1 SCALE=10000
DRIVE OPTION=MODIFY TYPE=COSINE COSFREQUENCY=0.1 SCALE=10000 | DRIVE UNPICK
SOLVERS ELEMENT=LINEAR,| SOLVERS SOLVENOW=YES SAVEMODEL=YES, | SOLVERS OPTION=TEST FILE='pure_perturbation_AC.op3' UNITS=METRE SURFACE=CURVED | COMMENT CLEAR=YES TYPE=DBTITLE | SOLVERS OPTION=OVERWRITE
MULTIPHYSICS OPTION=RESET
DBCASEDATA PROGRAM=TOSCAMAGN OPTION=CLEAR
ANALYSISDATA OPTION=SET PROGRAM=TOSCAMAGN CONVTOL=1e-08 HX=0 HY=0 HZ=0 LINEAR=YES POTENTIALCUT=YES RHS=ADAPTIVE SCALEDRIVE=ALL USEDEFORMEDMESH=NO USEDIRECTSOLVER=NO
DRIVE UNPICK | DRIVE GUIINIT
DRIVE PICK 'Perturbation'
DRIVE OPTION=MODIFY SCALE=10000 | DRIVE UNPICK
SOLVERS SOLVENOW=YES SAVEMODEL=YES, | SOLVERS OPTION=TEST FILE='pure_perturbation_AC.op3' UNITS=METRE ELEMENT=LINEAR SURFACE=CURVED | COMMENT CLEAR=YES TYPE=DBTITLE | SOLVERS OPTION=OVERWRITE
MULTIPHYSICS OPTION=RESET
ANALYSISDATA OPTION=SET PROGRAM=TOSCAMAGN HX=0 HY=0 HZ=0 LINEAR=NO NITERATIONS=21 NLITERTYPE=NEWTON POTENTIALCUT=YES RHS=ADAPTIVE SCALEDRIVE=ALL TOLERANCE=0.001 USEDEFORMEDMESH=NO USEDIRECTSOLVER=NO
SOLVERS SOLVENOW=YES SAVEMODEL=YES, | SOLVERS OPTION=TEST FILE='pure_perturbation_AC.op3' UNITS=METRE ELEMENT=LINEAR SURFACE=CURVED | COMMENT CLEAR=YES TYPE=DBTITLE | SOLVERS OPTION=OVERWRITE
MULTIPHYSICS OPTION=RESET
ANALYSISDATA OPTION=SET PROGRAM=ELEKTRATR DELTAT=0.5 HX=0 HY=0 HZ=0 LINEAR=NO LOGLIST= LOGLIST+=TTime NITERATIONS=21 NLITERTYPE=NEWTON RHS=ADAPTIVE TOLERANCE=0.001 UPDATE=SIMPLE USEDEFORMEDMESH=NO
DRIVE UNPICK | DRIVE GUIINIT
DRIVE PICK 'Perturbation'
DRIVE OPTION=MODIFY TYPE=COSINE COSFREQUENCY=0.1 SCALE=10000 | DRIVE UNPICK
SOLVERS ELEMENT=LINEAR,| SOLVERS SOLVENOW=NO SAVEMODEL=YES, | SOLVERS OPTION=TEST FILE='pure_perturbation_AC.op3' UNITS=METRE SURFACE=CURVED | COMMENT CLEAR=YES TYPE=DBTITLE | SOLVERS OPTION=OVERWRITE
STRAIGHT OPTION=LOAD
CEDITOR OPTION=START


PREVIEW OPTION=UNPICK REDISPLAY=YES
DRIVE UNPICK | DRIVE GUIINIT
DRIVE UNPICK
MULTIPHYSICS OPTION=RESET
DBCASEDATA PROGRAM=ELEKTRATR OPTION=ADD VALUE=0;100;1
ANALYSISDATA OPTION=SET PROGRAM=ELEKTRATR DELTAT=1 HX=0 HY=0 HZ=0 LINEAR=NO LOGLIST= LOGLIST+=TTime NITERATIONS=21 NLITERTYPE=NEWTON RHS=ADAPTIVE TOLERANCE=0.001 UPDATE=SIMPLE USEDEFORMEDMESH=NO

PREVIEW OPTION=UNPICK REDISPLAY=YES
DRIVE UNPICK | DRIVE GUIINIT
DRIVE PICK 'Perturbation'
DRIVE OPTION=MODIFY TYPE=COSINE COSFREQUENCY=0.1 SCALE=10000 | DRIVE UNPICK
PICK OPTION=GUIUPDATE
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Reduced
PICK OPTION=ADD, | PICK PROPERTY=Potential LABEL=Reduced
PICK OPTION=ADD, | PICK PROPERTY=Potential LABEL=Total
PICK OPTION=ADD, | PICK PROPERTY=Potential LABEL=Total
PICK OPTION=REMOVE, | PICK PROPERTY=Potential LABEL=Total
PICK OPTION=REMOVE, | PICK PROPERTY=Potential LABEL=Reduced
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Reduced
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Reduced
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Total
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Total
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Reduced
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Reduced
PICK OPTION=TOGGLE, | PICK PROPERTY=Size
PICK OPTION=TOGGLE, | PICK PROPERTY=Size
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Total
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Total
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Total
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Total
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Total
PICK OPTION=TOGGLE, | PICK PROPERTY=Potential LABEL=Total
MULTIPHYSICS OPTION=RESET
DBCASEDATA PROGRAM=ELEKTRATR OPTION=CLEAR
DBCASEDATA PROGRAM=ELEKTRATR OPTION=INSERT VALUE=0;100;1 INDEX=1
ANALYSISDATA OPTION=SET PROGRAM=ELEKTRATR DELTAT=1 HX=0 HY=0 HZ=0 LINEAR=NO LOGLIST= LOGLIST+=TTime NITERATIONS=21 NLITERTYPE=NEWTON RHS=ADAPTIVE TOLERANCE=0.001 UPDATE=SIMPLE USEDEFORMEDMESH=NO
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
$ COMI 'C:\Users\mzhao\OPERA_MSR\transient_test.comi'
